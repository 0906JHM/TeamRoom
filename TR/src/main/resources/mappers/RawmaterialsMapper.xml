<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="com.itwillbs.mappers.RawmaterialsMapper"> 
 
	<select id="getMaxNum" resultType="java.lang.Integer">
		select max(rawNum)
		from rawMaterial
	</select>

	<insert id="insertRawmaterials">
		insert into rawMaterial(rawNum,rawCode,rawName,rawType,rawUnit,rawPrice,clientCode,whseCode,rawMemo)
		values(#{rawNum},#{rawCode},#{rawName},#{rawType},#{rawUnit},#{rawPrice},#{clientCode},#{whseCode},#{rawMemo})
	</insert>
	
	<!-- home 페이징처리, 검색기능 -->
	<select id="getRawmaterialsList" resultType="com.itwillbs.domain.RawmaterialsDTO">
		select r.rawNum,r.rawCode,r.rawName,r.rawType,r.rawUnit,r.rawPrice,r.clientCode,r.whseCode,w.whseCount,r.rawMemo
		from rawMaterial r join warehouse w
		on r.whseCode = w.whseCode
		where 1=1
   		<if test="search1 != null and search1 != ''">
        	and r.rawCode like concat('%', #{search1}, '%')
    	</if>
    	<if test="search2 != null and search2 != ''">
        	and r.rawName like concat('%', #{search2}, '%')
    	</if>
   		<if test="search3 != null and search3 != ''">
       		and r.rawType = #{search3}
    	</if>
    	<if test="search4 != null and search4 != ''">
    		and r.clientCode like concat('%', #{search4}, '%')
    	</if>
    	order by rawNum desc limit #{startRow}, #{pageSize}
	</select>
	
	<!-- home 페이징처리, 검색기능 -->
 	<select id="getRawmaterialsCount" resultType="java.lang.Integer">
		select count(*)
      	from rawMaterial
     	where 1=1
   		<if test="search1 != null and search1 != ''">
        	and rawCode like concat('%', #{search1}, '%')
    	</if>
    	<if test="search2 != null and search2 != ''">
        	and rawName like concat('%', #{search2}, '%')
    	</if>
   		<if test="search3 != null and search3 != ''">
       		and rawType = #{search3}
    	</if>
    	<if test="search4 != null and search4 != ''">
    		and clientCode like concat('%', #{search4}, '%')
    	</if>
    </select>
	
	<!-- 체크박스로 선택삭제 -->
    <delete id="delete">
        delete from rawMaterial
        where rawCode = #{rawCode}
    </delete>
    
    <select id="getDetail" resultType="com.itwillbs.domain.RawmaterialsDTO">
		select *
		from rawMaterial
		where rawCode = #{rawCode}
	</select>
	
	<update id="updateRawmaterials">
		update rawMaterial
		set rawName=#{rawName}, rawType=#{rawType}, rawUnit=#{rawUnit}, rawPrice=#{rawPrice}, clientCode=#{clientCode}, whseCode=#{whseCode}, rawMemo=#{rawMemo}
		where rawCode = #{rawCode}
	</update>
	
	<!-- selectclient 페이징처리, 검색기능 -->
	<select id="getClientList" resultType="com.itwillbs.domain.ClientDTO">
		select *
		from clients
		where 1=1
   		<if test="search1 != null and search1 != ''">
        	and clientCode like concat('%', #{search1}, '%')
    	</if>
    	<if test="search2 != null and search2 != ''">
        	and clientCompany like concat('%', #{search2}, '%')
    	</if>
   		<if test="search3 != null and search3 != ''">
       		and clientType = #{search3}
    	</if>
    	<if test="search4 != null and search4 != ''">
    		and clientName like concat('%', #{search4}, '%')
    	</if>
     	order by clientCode asc limit #{startRow}, #{pageSize}
	</select>
	
	<!-- selectclient 페이징처리, 검색기능 -->
	<select id="getClientCount" resultType="java.lang.Integer">
      	select count(*)
      	from clients
      	where 1=1
   		<if test="search1 != null and search1 != ''">
        	and clientCode like concat('%', #{search1}, '%')
    	</if>
    	<if test="search2 != null and search2 != ''">
        	and clientCompany like concat('%', #{search2}, '%')
    	</if>
   		<if test="search3 != null and search3 != ''">
       		and clientType = #{search3}
    	</if>
    	<if test="search4 != null and search4 != ''">
    		and clientName like concat('%', #{search4}, '%')
    	</if>
 	</select>
 	
 	<!-- selectwarehouse 페이징처리, 검색기능 -->
	<select id="getWarehouseList" resultType="com.itwillbs.domain.WarehouseDTO">
		select *
		from warehouse
		where 1=1
   		<if test="search1 != null and search1 != ''">
        	and whseCode like concat('%', #{search1}, '%')
    	</if>
    	<if test="search2 != null and search2 != ''">
        	and whseName like concat('%', #{search2}, '%')
    	</if>
   		<if test="search3 != null and search3 != ''">
       		and whseType = #{search3}
    	</if>
    	<if test="search4 != null and search4 != ''">
       		and whseAddr = #{search4}
    	</if>
     	order by whseCode desc limit #{startRow}, #{pageSize}
	</select>
	
	<!-- selectwarehouse 페이징처리, 검색기능 -->
	<select id="getWarehouseCount" resultType="java.lang.Integer">
      	select count(*)
      	from warehouse
      	where 1=1
   		<if test="search1 != null and search1 != ''">
        	and whseCode like concat('%', #{search1}, '%')
    	</if>
    	<if test="search2 != null and search2 != ''">
        	and whseName like concat('%', #{search2}, '%')
    	</if>
   		<if test="search3 != null and search3 != ''">
       		and whseType = #{search3}
    	</if>
    	<if test="search4 != null and search4 != ''">
       		and whseAddr = #{search4}
    	</if>
 	</select>
 	
 	<select id="getMemo" resultType="com.itwillbs.domain.RawmaterialsDTO">
		select *
		from rawMaterial
		where rawCode = #{rawCode}
	</select>
 	
</mapper>